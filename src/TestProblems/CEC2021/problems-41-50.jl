function  CEC2021_func_41_50(x,func)
    # CEC2021_func Real world Multi-objective Constrained Optimization Test Suite 
    # Abhishek Kumar (email: abhishek.kumar.eee13@iitbhu.ac.in, Indian Institute of Technology (BHU), Varanasi) 

    # x -----> ps X D where 'ps': number of population and 'D': Dimension of
    # the problem.
    # f -----> Objective Function Value.
    # g -----> Inequality Consstraints Value; ps X ng where 'ng': number of
    # inequality constraints.
    # h -----> Equality Constraints Value; ps X nh where 'nh': number of
    # equality constraints.
    # prob_k -> Index of problem.

    D = length(x);
    if (func == 41)
        ## Optimal Power flow (Minimization of voltage deviation, Active and Reactive Power Loss)
        G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];

        B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];

        P = [   0.0000000000000000e+00;
             2.1700000000000000e-01;
             9.4200000000000006e-01;
             4.7799999999999998e-01;
             7.5999999999999998e-02;
             1.1199999999999999e-01;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             2.9499999999999998e-01;
             8.9999999999999997e-02;
             3.5000000000000003e-02;
             6.0999999999999999e-02;
             1.3500000000000001e-01;
             1.4899999999999999e-01];

        Q = [   0.0000000000000000e+00;
             1.2700000000000000e-01;
             1.9000000000000000e-01;
             -3.9000000000000000e-02;
             1.6000000000000000e-02;
             7.4999999999999997e-02;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             1.6600000000000001e-01;
             5.7999999999999996e-02;
             1.8000000000000002e-02;
             1.6000000000000000e-02;
             5.7999999999999996e-02;
             5.0000000000000003e-02];

        Y = G+im*B;
        ## voltage initilization
        V = zeros(Complex, 14);
        V[1]    = 1;
        Pg      = zeros(14);
        Qg      = zeros(14);

        V[2:14]   =     x[1:13 ]+ im*x[14:26];
        Pg[[2,3,6,8]] = x[27:30];
        Qg[[2,3,6,8]] = x[31:34];
        ## current calculation
        I    = Y*V;
        S    = V .* conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
        ## objective calculation
        f = zeros(2)
        f[1] = real(V[1] .* conj(I[1]))+sum(Psp[2:14]);
        f[2] = imag(V[1] .* conj(I[2]))+sum(Qsp[2:14]);
        h = vcat(delP[2:14],delQ[2:14]);

        g = zeros(1);
    elseif(func == 42)
        ## Optimal Power flow (Minimization of voltage deviation, Active and Reactive Power Loss)
        G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
        B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
        P = [   0.0000000000000000e+00;
             2.1700000000000000e-01;
             9.4200000000000006e-01;
             4.7799999999999998e-01;
             7.5999999999999998e-02;
             1.1199999999999999e-01;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             2.9499999999999998e-01;
             8.9999999999999997e-02;
             3.5000000000000003e-02;
             6.0999999999999999e-02;
             1.3500000000000001e-01;
             1.4899999999999999e-01];
        Q = [   0.0000000000000000e+00;
             1.2700000000000000e-01;
             1.9000000000000000e-01;
             -3.9000000000000000e-02;
             1.6000000000000000e-02;
             7.4999999999999997e-02;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             1.6600000000000001e-01;
             5.7999999999999996e-02;
             1.8000000000000002e-02;
             1.6000000000000000e-02;
             5.7999999999999996e-02;
             5.0000000000000003e-02];
        Y = G+im*B;
        ## voltage initilization
        V = zeros(Complex, 14);
        V[1]    = 1;
        Pg      = zeros(14);
        Qg      = zeros(14);

        V[2:14]   =     x[1:13 ]+ im*x[14:26];
        Pg[[2,3,6,8]] = x[27:30];
        Qg[[2,3,6,8]] = x[31:34];
        ## current calculation
        I    = Y*V;
        S    = V .* conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
        ## objective calculation
        f = zeros(2)
        f[1] = real(V[1] .* conj(I[1]))+sum(Psp[2:14]);
        f[2] = sum((1 .- abs.(V[2:14])) .^ 2);
        h = vcat(delP[2:14],delQ[2:14]);
        g = zeros(1);
    elseif (func == 43)
        ## Optimal Power flow (Minimization of Fuel Cost, active power loss)
        G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
        B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
        P = [   0.0000000000000000e+00;
             2.1700000000000000e-01;
             9.4200000000000006e-01;
             4.7799999999999998e-01;
             7.5999999999999998e-02;
             1.1199999999999999e-01;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             2.9499999999999998e-01;
             8.9999999999999997e-02;
             3.5000000000000003e-02;
             6.0999999999999999e-02;
             1.3500000000000001e-01;
             1.4899999999999999e-01];
        Q = [   0.0000000000000000e+00;
             1.2700000000000000e-01;
             1.9000000000000000e-01;
             -3.9000000000000000e-02;
             1.6000000000000000e-02;
             7.4999999999999997e-02;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             1.6600000000000001e-01;
             5.7999999999999996e-02;
             1.8000000000000002e-02;
             1.6000000000000000e-02;
             5.7999999999999996e-02;
             5.0000000000000003e-02];
        Y = G+im*B;
        ## voltage initilization
        V = zeros(Complex, 14);
        V[1]    = 1;
        Pg      = zeros(14);
        Qg      = zeros(14);
        ng      = [1,2,3,6,8];
        a1      = [0,0,0,0,0];
        b1      = [ 2, 1.75,1,3.25,3];
        c1      = [ 0.02,0.0175,0.0625, 0.00834, 0.025];

        V[2:14]   =     x[1:13 ]+ im*x[14:26];
        Pg[[2,3,6,8]] = x[27:30];
        Qg[[2,3,6,8]] = x[31:34];
        ## current calculation
        I    = Y*V;
        S    = V .* conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
        ## objective calculation
        f = zeros(2)
        f[1] = sum(a1 + b1 .* Pg[ng] + c1 .* (Pg[ng] .^ 2));
        f[2] = real(V[1] .* conj(I[1]))+sum(Psp[2:14]);
        h = vcat(delP[2:14],delQ[2:14]);

        g = zeros(1);
    elseif (func == 44)
        ## Optimal Power flow (Minimization of Fuel Cost, active and reactive power loss)
        G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
        B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
        P = [   0.0000000000000000e+00;
             2.1700000000000000e-01;
             9.4200000000000006e-01;
             4.7799999999999998e-01;
             7.5999999999999998e-02;
             1.1199999999999999e-01;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             2.9499999999999998e-01;
             8.9999999999999997e-02;
             3.5000000000000003e-02;
             6.0999999999999999e-02;
             1.3500000000000001e-01;
             1.4899999999999999e-01];
        Q = [   0.0000000000000000e+00;
             1.2700000000000000e-01;
             1.9000000000000000e-01;
             -3.9000000000000000e-02;
             1.6000000000000000e-02;
             7.4999999999999997e-02;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             1.6600000000000001e-01;
             5.7999999999999996e-02;
             1.8000000000000002e-02;
             1.6000000000000000e-02;
             5.7999999999999996e-02;
             5.0000000000000003e-02];
        Y = G+im*B;
        ## voltage initilization
        V = zeros(Complex,14);
        V[1]    = 1;
        Pg      = zeros(14);
        Qg      = zeros(14);
        ng      = [1,2,3,6,8];
        a1      = [0,0,0,0,0];
        b1      = [ 2, 1.75,1,3.25,3];
        c1      = [ 0.02,0.0175,0.0625, 0.00834, 0.025];

        V[2:14]   =     x[1:13 ]+ im*x[14:26];
        Pg[[2,3,6,8]] = x[27:30];
        Qg[[2,3,6,8]] = x[31:34];
        ## current calculation
        I    = Y*V;
        S    = V .* conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
        ## objective calculation

        f = zeros(3)
        f[1] = sum(a1 + b1 .* Pg[ng] + c1 .* (Pg[ng] .^ 2));
        f[2] = real(V[1] .* conj(I[1]))+sum(Psp[2:14]);
        f[3] = imag(V[1] .* conj(I[1]))+sum(Qsp[2:14]);
        h = vcat(delP[2:14],delQ[2:14]);
        g = zeros(1);
    elseif (func == 45)
        ## Optimal Power flow (Minimization of Fuel Cost, voltage deviation and active power loss)
        G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
        B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
        P = [   0.0000000000000000e+00;
             2.1700000000000000e-01;
             9.4200000000000006e-01;
             4.7799999999999998e-01;
             7.5999999999999998e-02;
             1.1199999999999999e-01;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             2.9499999999999998e-01;
             8.9999999999999997e-02;
             3.5000000000000003e-02;
             6.0999999999999999e-02;
             1.3500000000000001e-01;
             1.4899999999999999e-01];
        Q = [   0.0000000000000000e+00;
             1.2700000000000000e-01;
             1.9000000000000000e-01;
             -3.9000000000000000e-02;
             1.6000000000000000e-02;
             7.4999999999999997e-02;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             1.6600000000000001e-01;
             5.7999999999999996e-02;
             1.8000000000000002e-02;
             1.6000000000000000e-02;
             5.7999999999999996e-02;
             5.0000000000000003e-02];
        Y = G+im*B;
        ## voltage initilization
        V = zeros(Complex, 14);
        V[1]    = 1;
        Pg      = zeros(14);
        Qg      = zeros(14);

        ng      = [1,2,3,6,8];
        a1      = [0,0,0,0,0];
        b1      = [ 2, 1.75,1,3.25,3];
        c1      = [ 0.02,0.0175,0.0625, 0.00834, 0.025];

        V[2:14]   =     x[1:13 ]+ im*x[14:26];
        Pg[[2,3,6,8]] = x[27:30];
        Qg[[2,3,6,8]] = x[31:34];
        ## current calculation
        I    = Y*V;
        S    = V .* conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;
        ## objective calculation
        f = zeros(3)
        f[1] = sum(a1 + b1 .* Pg[ng] + c1 .* (Pg[ng] .^ 2));
        f[2] = real(V[1] .* conj(I[1]))+sum(Psp[2:14]);
        f[3] = sum((1 .- abs.(V[2:14])) .^ 2);
        h = vcat(delP[2:14],delQ[2:14]);

        g = zeros(1);
    elseif (func == 46)
        ## Optimal Power flow (Minimization of Fuel Cost, voltage deviation, active and reactive power loss)
        G = [   6.0250290557682238e+00  -4.9991316007980346e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.0258974549701889e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -4.9991316007980346e+00   9.5213236108147790e+00  -1.1350191923073958e+00  -1.6860331506149431e+00  -1.7011396670944048e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.1350191923073958e+00   3.1209949022329564e+00  -1.9859757099255606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00  -1.6860331506149431e+00  -1.9859757099255606e+00   1.0512989522036175e+01  -6.8409806614956707e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             -1.0258974549701889e+00  -1.7011396670944048e+00   0.0000000000000000e+00  -6.8409806614956707e+00   9.5680177835602649e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.5799234074662225e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00  -1.5259674404509740e+00  -3.0989274038379877e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.3260550394673585e+00  -3.9020495524474277e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.9020495524474277e+00   5.7829343061478271e+00  -1.8808847537003996e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9550285631772606e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.8808847537003996e+00   3.8359133168776602e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.5259674404509740e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0149920272728927e+00  -2.4890245868219187e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -3.0989274038379877e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -2.4890245868219187e+00   6.7249461484662332e+00  -1.1369941578063267e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.4240054870199310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.1369941578063267e+00   2.5609996448262580e+00];
        B = [  -1.9447070205514382e+01   1.5263086523179553e+01   0.0000000000000000e+00   0.0000000000000000e+00   4.2349836823348310e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             1.5263086523179553e+01  -3.0272115398779064e+01   4.7818631517577179e+00   5.1158383258720832e+00   5.1939273979697127e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   4.7818631517577179e+00  -9.8223801293516395e+00   5.0688169775939205e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   5.1158383258720832e+00   5.0688169775939205e+00  -3.8654171207607796e+01   2.1578553981691588e+01   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             4.2349836823348310e+00   5.1939273979697127e+00   0.0000000000000000e+00   2.1578553981691588e+01  -3.5533639456044824e+01   4.2574453352533839e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.2574453352533839e+00  -1.7340732809919110e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   3.1759639650294003e+00   6.1027554481931157e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.8895126603173411e+00   0.0000000000000000e+00   0.0000000000000000e+00  -1.9549005948264654e+01   5.6769798467215438e+00   9.0900827197527505e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   5.6769798467215438e+00  -5.6769798467215438e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.8554995578159004e+00   0.0000000000000000e+00   0.0000000000000000e+00   9.0900827197527505e+00   0.0000000000000000e+00  -2.4092506375267877e+01   1.0365394127060915e+01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0365394127060915e+01  -1.4768337876521436e+01   4.4029437494605208e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.0940743442404415e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   4.4029437494605208e+00  -8.4970180937009623e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.1759639650294003e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00  -5.4279385912016123e+00   2.2519746261722120e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   6.1027554481931157e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.2519746261722120e+00  -1.0669693549470679e+01   2.3149634751053521e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   3.0290504569306034e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   2.3149634751053521e+00  -5.3440139320359554e+00];
        P = [   0.0000000000000000e+00;
             2.1700000000000000e-01;
             9.4200000000000006e-01;
             4.7799999999999998e-01;
             7.5999999999999998e-02;
             1.1199999999999999e-01;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             2.9499999999999998e-01;
             8.9999999999999997e-02;
             3.5000000000000003e-02;
             6.0999999999999999e-02;
             1.3500000000000001e-01;
             1.4899999999999999e-01];
        Q = [   0.0000000000000000e+00;
             1.2700000000000000e-01;
             1.9000000000000000e-01;
             -3.9000000000000000e-02;
             1.6000000000000000e-02;
             7.4999999999999997e-02;
             0.0000000000000000e+00;
             0.0000000000000000e+00;
             1.6600000000000001e-01;
             5.7999999999999996e-02;
             1.8000000000000002e-02;
             1.6000000000000000e-02;
             5.7999999999999996e-02;
             5.0000000000000003e-02];
        Y = G+im*B;
        ## voltage initilization
        V = zeros(Complex, 14);
        V[1]    = 1;
        Pg      = zeros(14);
        Qg      = zeros(14);

        ng      = [1,2,3,6,8];
        a1      = [0,0,0,0,0];
        b1      = [ 2, 1.75,1,3.25,3];
        c1      = [ 0.02,0.0175,0.0625, 0.00834, 0.025];

        V[2:14]   =     x[1:13 ]+ im*x[14:26];
        Pg[[2,3,6,8]] = x[27:30];
        Qg[[2,3,6,8]] = x[31:34];
        ## current calculation
        I    = Y*V;
        S    = V .* conj(I);
        Psp  = real(S);
        Qsp  = imag(S);
        delP = Psp-Pg+P;
        delQ = Qsp-Qg+Q;

        ## objective calculation
        f = zeros(4)
        f[1] = sum(a1 + b1 .* Pg[ng] + c1 .* (Pg[ng] .^ 2));
        f[2] = real(V[1] .* conj(I[1]))+sum(Psp[2:14]);
        f[3] = imag(V[1] .* conj(I[1]))+sum(Qsp[2:14]);
        f[4] = sum((1 .-abs.(V[2:14])) .^ 2);
        h = vcat(delP[2:14],delQ[2:14]);

        g = zeros(1);

    elseif (func == 47)
        ## Optimal Setting of Droop Controller for Minimization of Active Power Loss in Islanded Microgrids
        P = [   1.6138989835002382e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             2.1451873678268588e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
        Q = [   1.0680528035555388e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             1.5161777012574437e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
        L = [   1.0000000000000000e+00   2.0000000000000000e+00   2.6660053320106641e-01   7.4329468658937317e-02   0.0000000000000000e+00   1.0000000000000000e+00;
             1.0000000000000000e+00   4.0000000000000000e+00   1.8600037200074401e-01   8.1809163618327255e-02   0.0000000000000000e+00   1.0000000000000000e+00;
             2.0000000000000000e+00   5.0000000000000000e+00   1.2400024800049600e-01   5.8435116870233741e-02   0.0000000000000000e+00   1.0000000000000000e+00;
             2.0000000000000000e+00   3.0000000000000000e+00   9.3000186000372007e-02   4.3078368156736313e-01   0.0000000000000000e+00   1.0000000000000000e+00;
             3.0000000000000000e+00   6.0000000000000000e+00   3.1000062000124000e-02   1.1687023374046750e-02   0.0000000000000000e+00   1.0000000000000000e+00];

        ## voltage initilization
        V = zeros(Complex, 6);
        V[1]    = 1;
        Pc     = zeros(6);
        Qc     = zeros(6);


        V[2:6]   = x[1:5]+im*x[6:10];
        w         = x[11];
        V[1]      = x[12]+1e-5;

        Pc[[4,5,6]] = x[13:15];
        Qc[[4,5,6]] = x[16:18];

        ## current calculation
        Y    = ybus(L,w);
        I    = Y*V;
        Ir   = real(I);
        Im   = imag(I);
        Vr   = real(V);
        Vm   = imag(V);

        Psp  = Pc .* (1-w)-P[:,1] .* (abs.(V) ./ P[:,5]) .^ P[:,6];
        Qsp  = Qc .* (1 .- sqrt.(Vr .^ 2+Vm .^ 2))-Q[:,1] .* (abs.(V) ./ Q[:,5]) .^ Q[:,6];
        spI  = conj((Psp+im*Qsp) ./ V);
        spIr = real(spI);
        spIm = imag(spI);
        delIr = Ir-spIr;
        delIm = Im-spIm;

        ## objective calculation
        f = zeros(2)
        f[1] = sum(Psp) ;
        f[2] = sum(Qsp) ;

        h = vcat(delIr[1:6], delIm[1:6]);

        g = zeros(1); 

    elseif (func == 48)
        ## Optimal Setting of Droop Controller for Minimization of Active Power Loss in Islanded Microgrids
        P = [   1.6138989835002382e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             2.1451873678268588e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
        Q = [   1.0680528035555388e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             1.5161777012574437e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
        L = [   1.0000000000000000e+00   2.0000000000000000e+00   2.6660053320106641e-01   7.4329468658937317e-02   0.0000000000000000e+00   1.0000000000000000e+00;
             1.0000000000000000e+00   4.0000000000000000e+00   1.8600037200074401e-01   8.1809163618327255e-02   0.0000000000000000e+00   1.0000000000000000e+00;
             2.0000000000000000e+00   5.0000000000000000e+00   1.2400024800049600e-01   5.8435116870233741e-02   0.0000000000000000e+00   1.0000000000000000e+00;
             2.0000000000000000e+00   3.0000000000000000e+00   9.3000186000372007e-02   4.3078368156736313e-01   0.0000000000000000e+00   1.0000000000000000e+00;
             3.0000000000000000e+00   6.0000000000000000e+00   3.1000062000124000e-02   1.1687023374046750e-02   0.0000000000000000e+00   1.0000000000000000e+00];
        ## voltage initilization
        V = zeros(Complex, 6);
        V[1]    = 1;
        Pc     = zeros(6);
        Qc     = zeros(6);

        V[2:6]   =  x[1:5]+im*x[6:10];
        w         = x[ 11];
        V[1]      = x[ 12]+1e-5;
        Pc[[4,5,6]] = x[13:15];
        Qc[[4,5,6]] = x[16:18];
        ## current calculation
        Y    = ybus(L,w);
        I    = Y*V;
        Ir   = real(I);
        Im   = imag(I);
        Vr   = real(V);
        Vm   = imag(V);
        Psp  = Pc .* (1-w)-P[:,1] .* (abs.(V) ./ P[:,5]) .^ P[:,6];
        Qsp  = Qc .* (1 .-sqrt.(Vr .^ 2+Vm .^ 2))-Q[:,1] .* (abs.(V) ./ Q[:,5]) .^ Q[:,6];

        spI  = conj((Psp+im*Qsp) ./ V);
        spIr = real(spI);
        spIm = imag(spI);
        delIr = Ir-spIr;
        delIm = Im-spIm;
        ## objective calculation
        f = zeros(2)
        f[1] = sum(Psp) ;
        f[2] = sum((1 .-abs.(V)) .^ 2) ;
        h = vcat(delIr[1:6], delIm[1:6]);

        g = zeros(1); 
    elseif (func == 49)
        ## Optimal Setting of Droop Controller for Minimization of Active Power Loss in Islanded Microgrids
        P = [   1.6138989835002382e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             2.1451873678268588e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
        Q = [   1.0680528035555388e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             1.5161777012574437e-01   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00;
             0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   0.0000000000000000e+00   1.0000000000000000e+00   0.0000000000000000e+00];
        L = [   1.0000000000000000e+00   2.0000000000000000e+00   2.6660053320106641e-01   7.4329468658937317e-02   0.0000000000000000e+00   1.0000000000000000e+00;
             1.0000000000000000e+00   4.0000000000000000e+00   1.8600037200074401e-01   8.1809163618327255e-02   0.0000000000000000e+00   1.0000000000000000e+00;
             2.0000000000000000e+00   5.0000000000000000e+00   1.2400024800049600e-01   5.8435116870233741e-02   0.0000000000000000e+00   1.0000000000000000e+00;
             2.0000000000000000e+00   3.0000000000000000e+00   9.3000186000372007e-02   4.3078368156736313e-01   0.0000000000000000e+00   1.0000000000000000e+00;
             3.0000000000000000e+00   6.0000000000000000e+00   3.1000062000124000e-02   1.1687023374046750e-02   0.0000000000000000e+00   1.0000000000000000e+00];
        ## voltage initilization
        V = zeros(Complex, 6);
        V[1]    = 1;
        Pc     = zeros(6);
        Qc     = zeros(6);

        V[2:6]   = x[1:5]+im*x[6:10];
        w         = x[11];
        V[1]      = x[12]+1e-5;

        Pc[[4,5,6]] = x[13:15];
        Qc[[4,5,6]] = x[16:18];

        ## current calculation
        Y    = ybus(L,w);
        I    = Y*V;
        Ir   = real(I);
        Im   = imag(I);
        Vr   = real(V);
        Vm   = imag(V);
        Psp  = Pc .* (1-w)-P[:,1] .* (abs.(V) ./ P[:,5]) .^ P[:,6];
        Qsp  = Qc .* (1 .-sqrt.(Vr .^ 2+Vm .^ 2))-Q[:,1] .* (abs.(V) ./ Q[:,5]) .^ Q[:,6];
        spI  = conj((Psp+im*Qsp) ./ V);
        spIr = real(spI);
        spIm = imag(spI);
        delIr = Ir-spIr;
        delIm = Im-spIm;
        ## objective calculation
        f = zeros(3)
        f[1] = sum(Psp) ;
        f[2] = sum(Qsp) ;
        f[3] = sum((1 .- abs.(V)) .^ 2) ;
        h = vcat(delIr[1:6], delIm[1:6]);

        g = zeros(1); 
    elseif func == 50
        ## Power Distribution System Planning
        N = D;
        P = x;
        PD = 1200;
        B =[140 17 15 19 26 22;
            17 60 13 16 15 20;
            15 13 65 17 24 19;
            19 16 17 71 30 25;
            26 15 24 30 69 32;
            22 20 19 25 32 85] * 10^-6;
        a = [756.7988 451.3251 1243.5311 1049.9977 1356.6592 1658.5696];
        b = [38.5390  46.1591 38.3055  40.3965 38.2704 36.3278];
        c = [0.15247  0.10587  0.03546  0.02803  0.01799 0.02111];
        alpha = [13.8593 13.8593  40.2669  40.2669 42.8955 42.8955];
        beta = [0.32767  0.32767 -0.54551 -0.54551 -0.51116 -0.51116];
        gamma = [0.00419 0.00419  0.00683  0.00683 0.00461 0.00461];

        PL = 0;
        for i = 1:N
            for j = 1:N
                PL = PL + P[i]  .*  B[i,j]  .*  P[j];
            end
        end

        # objectives
        f = zeros(2);
        for i = 1:N
            f[1] = f[1] + a[i] + b[i]  .*  P[i] + c[i]  .*  P[i] .^ 2 ;
        end
        for i = 1:N
            f[2] = f[2] + alpha[i] + beta[i]  .*  P[i] + gamma[i]  .*  P[i] .^ 2;
        end
        # constraints
        g = zeros(1);
        h = [sum(P)-PD-PL];
    end

    return f, g, h
end
## Program to for Admittance And Impedance Bus Formation.

function  ybus(linedata,f)  # Returns Y
    linedata[:,4] = linedata[:,4] .* f;
    # linedata(:,3:4) = linedata(:,3:4) .* 10000/127^2;
    # linedata(:,3:4) = linedata(:,3:4);


    fb = floor.(Int, linedata[:,1]);             # From bus number
    tb = floor.(Int, linedata[:,2]);             # To bus number
    r = linedata[:,3];              # Resistance, R
    x = linedata[:,4];              # Reactance, X
    b = linedata[:,5];              # Ground Admittance, B/2
    a = linedata[:,6];              # Tap setting value..
    z = r + im*x;                    # z matrix
    y = 1 ./ z;                       # To get inverse of each element
    b = im*b;                        # Make B imaginary

    nb = floor(Int, max(maximum(fb),maximum(tb)));      # No. of buses
    nl = length(fb);                # No. of branches
    Y = zeros(Complex, nb,nb);               # Initialise YBus

    # Formation of the Off Diagonal Elements
    for k = 1:nl
        Y[fb[k],tb[k]] = Y[fb[k],tb[k]] - y[k]/a[k];
        Y[tb[k],fb[k]] = Y[fb[k],tb[k]];
    end

    # Formation of Diagonal Elements.
    for m = 1:nb
        for n = 1:nl
            if fb[n] == m
                Y[m,m] = Y[m,m] + y[n]/(a[n]^2) + b[n];
            elseif tb[n] == m
                Y[m,m] = Y[m,m] + y[n] + b[n];
            end
        end
    end

    return Y
end
